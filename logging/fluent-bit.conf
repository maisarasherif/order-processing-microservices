[SERVICE]
    Flush        5
    Daemon       Off
    Log_Level    info
    Parsers_File parsers.conf
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020
    Health_Check On

# Order Service Logs
[INPUT]
    Name              forward
    Listen            0.0.0.0
    Port              24224
    Tag               order-service

# Payment Service Logs
[INPUT]
    Name              forward
    Listen            0.0.0.0
    Port              24225
    Tag               payment-service

# Notification Service Logs
[INPUT]
    Name              forward
    Listen            0.0.0.0
    Port              24226
    Tag               notification-service

# Parse JSON from the log field
[FILTER]
    Name                parser
    Match               *
    Key_Name            log
    Parser              docker_json
    Reserve_Data        On

# Add cluster metadata
[FILTER]
    Name                modify
    Match               *
    Add                 cluster_name microservices-cluster

# Output to Elasticsearch
[OUTPUT]
    Name                es
    Match               *
    Host                elasticsearch
    Port                9200
    Index               microservices-logs
    Logstash_Format     On
    Logstash_Prefix     microservices
    Retry_Limit         5
    Replace_Dots        On
    Trace_Error         On
    Suppress_Type_Name  On